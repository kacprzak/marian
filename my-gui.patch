Index: Common/FileSystemInfo/FileSystemInfo.h
===================================================================
--- Common/FileSystemInfo/FileSystemInfo.h	(wersja 5287)
+++ Common/FileSystemInfo/FileSystemInfo.h	(kopia robocza)
@@ -17,6 +17,7 @@
 #include <sys/types.h>
 #include <sys/stat.h>
 #include <unistd.h>
+#include <fnmatch.h>
 #endif
 
 #include <string>
@@ -132,12 +133,13 @@
 
 		while ((dp = readdir (dir)) != NULL)
 		{
-			if (!isReservedDir(MyGUI::UString(dp->d_name).asWStr_c_str()))
+			if ((fnmatch(MyGUI::UString(_mask).asUTF8_c_str(), dp->d_name, 0) == 0) && !isReservedDir(MyGUI::UString(dp->d_name).asWStr_c_str()))
 			{
 				struct stat fInfo;
-				char path[NAME_MAX];
-				//snprintf(path, NAME_MAX, "%s/%s", MyGUI::UString(_folder).asUTF8_c_str(), dp->d_name);
-				if (stat(path, &fInfo) == -1)perror("stat");
+				char path[PATH_MAX];
+				snprintf(path, PATH_MAX, "%s/%s", MyGUI::UString(_folder).asUTF8_c_str(), dp->d_name);
+				if (stat(path, &fInfo) == -1)
+				    perror("stat");
 				_result.push_back(FileInfo(MyGUI::UString(dp->d_name).asWStr(), (S_ISDIR(fInfo.st_mode))));
 			}
 		}
